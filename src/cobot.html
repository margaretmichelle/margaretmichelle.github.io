<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Margaret Lee | TMS Cobot</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="projects.css">
    <link rel="stylesheet" href="https://necolas.github.io/normalize.css/8.0.1/normalize.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alice&family=Kumbh+Sans&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
          <!-- <span class="menu-toggle">&#9776;</span> -->
          <ul class="nav-links">
            <li><a href="../index.html#home" class="nav-item">Home</a></li>
            <li><a href="../index.html#about" class="nav-item">About</a></li>
            <li><a href="../index.html#projects" class="nav-item">Projects</a></li>
            <li><a href="Resume_MargaretLee.pdf" class="nav-item">Resume</a></li>
            <li><a href="https://www.linkedin.com/in/lee-margaret/" class=""nav-item>
              <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg">
                <path
                class="linkedin-svg"
                d="M20 3H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1zM8.339 18.337H5.667v-8.59h2.672v8.59zM7.003 8.574a1.548 1.548 0 1 1 0-3.096 1.548 1.548 0 0 1 0 3.096zm11.335 9.763h-2.669V14.16c0-.996-.018-2.277-1.388-2.277-1.39 0-1.601 1.086-1.601 2.207v4.248h-2.667v-8.59h2.56v1.174h.037c.355-.675 1.227-1.387 2.524-1.387 2.704 0 3.203 1.778 3.203 4.092v4.71z"/>
              </svg>
              </a>
            </li>
          </ul>
        </div>
      </nav>

    <main>
        <div class="header">
            <h1>TMS Cobot</h1>
            <p>| ENPH 459 | 2023-2024 |</p>
        </div>
        <div id="tools-overview">
            <div class="container">
                <!-- Left Column: Tools -->
                <div class="left-column">
                    <h2>Tools</h2>
                    <ul>
                        <li>UR3e robot arm</li>
                        <li>Python</li>
                        <li>ROS</li>
                        <li>OptiTrack/Motive</li>
                        <li>Force/Torque sensor</li>
                        <li>Signal processing</li>
                        <li>Linux</li>
                    </ul>
                </div>

                <!-- Right Column: Overview -->
                <div class="right-column">
                    <h2>Overview</h2>
                    <p>We developed a robotic system designed to compensate for patient movement while stimulating the brain with a TMS 
                        coil for our 4th year capstone project. Using my knowledge of robot dynamics learned from ETH Zurich, I programmed 
                        a cobot arm in Python to follow a surrogate patient's head in 6 degrees of freedom using fiducial 
                        markers and an IR stereo camera.
                        </p>
                </div>
            </div>
        </div>
        <br>
      <div class="p-image-container">
        <figure>
            <img src="../images/cobot2.png" alt="Cobot with TMS coil and handheld patient stand-in with markers" class="portfolio-image">
            <figcaption>Cobot with TMS coil and handheld patient stand-in with IR reflective markers</figcaption>
        </figure>
      </div>
  
      <section class="project">
        <p>
            Transcranial Magnetic Stimulation (TMS) is a non-invasive medical procedure where certain regions of the brain are stimulated by a magnetic field 
            to induce electrical activity. This is typically used to treat depression. Sponsored by the NINET lab at UBC Department of Psychiatry, 
            my team of four ENPH students worked to develop a system to automate the procedure to increase the precision of stimulation. The main 
            issue we tackled was compensating for small movements of the patient during treatment that can misalign the TMS coil providing treatment 
            and the target region in the brain determined by digital MRI mapping. Using a Universal Robots collaborative robot (cobot) arm, ROS, 
            Python, and an OptiTrack camera paired with Motive, we were successfully able to follow the linear and rotational movement of a surrogate 
            patient head.
        </p>
        <br>
        <div class="p-image-container">
            <figure>
                <img src="../images/cobot4.gif" alt="GIF of cobot arm following patient stand-in with markers" class="portfolio-image">
                <figcaption>Cobot arm following the markers using (offscreen) IR camera</figcaption>
            </figure>
        </div>
        <br>
        <p>
            The OptiTrack stereo camera identifies the position of "rigid bodies" using three IR reflective markers. We tranformed the position and orientation  
            of the "patient" from image space (the camera coordinate system) to robot space (the cobot's base coordinate system) using a series of three-dimensional 
            affine transformations. We determined the difference, or the error, between the current cobot pose and the desired robot pose based on where the 
            "patient" is. A PD (proportional and derivative) control algorithm was used to control the linear and angular velocity of the TMS coil on the end of 
            the cobot arm. We also explored using the integrated force/torque sensor to maintain a constant, light pressure on the "patient head" and to implement 
            safety measures.
        </p>
        <br>
        <div class="p-image-container">
            <figure>
                <img src="../images/cobot5.gif" alt="GIF of Motive software with camera tracking patient head" class="portfolio-image">
                <figcaption>Motive software tracking Ernie, our "patient head"</figcaption>
            </figure>
        </div>
        <br>
        <div class="p-image-container">
            <video width="auto" height="450px" controls class="portfolio-video">
                <source src="../images/cobot8.mov" type="video/mp4">
              Your browser does not support the video tag.
              </video>
              <figcaption>Cobot maintaining a constant force feedback</figcaption>
        </div>
        <br>
        <div class="p-image-container">
            <figure>
                <img src="../images/cobot3.png" alt="Capstone team with camera, robot, TMS coil setup at project fair" class="portfolio-image">
                <figcaption>My capstone team at the project fair showcasing our system</figcaption>
            </figure>
        </div>
      </section>

    </main>

    <a href="enph353.html" class="next-project-btn">
        Go to Next Project &rarr;
    </a>


    <!-- Footer Section -->
    <footer id="footer">
        <div class="footer-content">
            <p>Made by Margaret 2025</p>
        </div>
      </footer>

      <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default'></script>

  </body>
  </html>